---
title: "Moderator analyses and meta-regression"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_vignette:
    df_print: paged
vignette: >
  %\VignetteIndexEntry{Moderator analyses and meta-regression}
  %\VignetteEngine{knitr::rmarkdown}
  %\usepackage[utf8]{inputenc}
csl: https://zotero.org/styles/apa
bibliography: vignette.yaml
---

**Note: This vignette is a work in progress.** 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(psychmeta)
```

## Specifying moderators

Moderator analyses are easyâ€”just identify a column or matrix of moderator information.
```{r, eval=FALSE}
ma_r(rxyi = rxyi, n = n,
     moderators = moderator,
     data = data_r_meas_multi)
```

To use multiple moderators, supply the column names as a string vector.
```{r, eval=FALSE}
ma_obj_gm <- 
  ma_r(rxyi = rxyi, n = n,
       moderators = c("Rating source", "Published", "Complexity"),
       data = data_r_gonzalezmule_2014)
```

By default, categorical moderators are analyzed using simple moderator analysis
(one moderator variable at a time). To conduct hierarchical moderator analyses
where multiple moderator variables are crossed, specify `moderatyor_type = "hierarhical".

```{r, eval=FALSE}
ma_r(ma_method = "ic",
    rxyi = rxyi, n = n,
    rxx = rxxi,
    ryy = ryyi,
    moderators = c("Rating source", "Complexity"),
    moderator_type = "hierarchical",
    data = data_r_gonzalezmule_2014)
```

Results for subgroup analyses for different levels of categorical moderators are
shown in the rows of the meta-analysis results table. To estimate confidence
intervals for differences between levels or an omnibus ANOVA statistic, use the
`anova()` function:

```{r, eval=FALSE}
anova(ma_obj_gm)
```

## Meta-regression

## `metareg()`

`metareg()` computes meta-regression results using both categorical and continuous moderators via the `rma()` function from the **`metafor`** package.

```{r, eval=FALSE}
ma_obj_gm <- metareg(ma_obj_gm)
get_metareg(ma_obj = ma_obj_gm)[[1]]$individual_correction$true_score

ma_obj_mc <- ma_r(ma_method = "ic",
                  rxyi = r, n = N,
                  moderators = c("Parent", "Age"),
                  cat_moderators = c(TRUE, FALSE),
                  data = data_r_mcleod_2007)

ma_obj_mc <- metareg(ma_obj_mc, formula_list = list("Parent*Age" = yi ~ Parent*Age))
get_metareg(ma_obj_mc)[[1]]$individual_correction$true_score
```

Note that the relevant sample size for meta-regression is the number of studies (_k_). Meta-regression results should be interpreted cautiously when _k_ is small or when there is low variability in moderator levels across studies [@SchmidtMetaRegression2017]. In these and other cases, hierarhical subgroup moderator analyses can yield more reliable results:

# Bibliography